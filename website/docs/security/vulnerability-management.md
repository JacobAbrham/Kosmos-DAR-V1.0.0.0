# Vulnerability Management

**Document Type:** Security Operations  
**Owner:** Security Team  
**Reviewers:** CISO, Platform Engineering, SRE  
**Review Cadence:** Quarterly  
**Last Updated:** 2025-12-13  
**Status:** ğŸŸ¢ Active

---

## Executive Summary

This document defines the vulnerability management program for KOSMOS, including scanning procedures, severity classification, remediation SLAs, and exception handling. The goal is to identify, assess, and remediate vulnerabilities before they can be exploited.

---

## Vulnerability Management Lifecycle

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  Vulnerability Management Lifecycle                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                          â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚   â”‚ Discover â”‚â”€â”€â”€â–¶â”‚  Assess  â”‚â”€â”€â”€â–¶â”‚Prioritizeâ”‚â”€â”€â”€â–¶â”‚Remediate â”‚         â”‚
â”‚   â”‚          â”‚    â”‚          â”‚    â”‚          â”‚    â”‚          â”‚         â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚        â”‚                                               â”‚                 â”‚
â”‚        â”‚                                               â”‚                 â”‚
â”‚        â”‚              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                     â”‚                 â”‚
â”‚        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚  Report  â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚
â”‚                       â”‚          â”‚                                       â”‚
â”‚                       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                       â”‚
â”‚                            â”‚                                             â”‚
â”‚                            â–¼                                             â”‚
â”‚                       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                       â”‚
â”‚                       â”‚  Verify  â”‚                                       â”‚
â”‚                       â”‚          â”‚                                       â”‚
â”‚                       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                       â”‚
â”‚                                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Scanning Coverage

### Scan Types and Schedule

| Scan Type | Tool | Frequency | Scope | Owner |
|-----------|------|-----------|-------|-------|
| **Container Images** | Trivy | Every build | All images | CI/CD |
| **Dependencies (SCA)** | Snyk | Daily | All repos | Security |
| **Static Analysis (SAST)** | Semgrep | Every PR | Source code | DevSecOps |
| **Dynamic Analysis (DAST)** | OWASP ZAP | Weekly | Staging APIs | Security |
| **Infrastructure** | Prowler | Daily | Cloud resources | Security |
| **Kubernetes** | Kubescape | Daily | K8s configs | Platform |
| **Secrets** | Trufflehog | Every commit | Git history | CI/CD |

### Scanning Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Vulnerability Scanning Stack                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚   â”‚   GitHub    â”‚  â”‚   GitHub    â”‚  â”‚      Container         â”‚â”‚
â”‚   â”‚   Actions   â”‚  â”‚  Dependabot â”‚  â”‚      Registry          â”‚â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚          â”‚                â”‚                      â”‚              â”‚
â”‚          â–¼                â–¼                      â–¼              â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚                 Security Aggregator                      â”‚  â”‚
â”‚   â”‚            (Vulnerability Dashboard)                     â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚          â”‚                â”‚                      â”‚              â”‚
â”‚          â–¼                â–¼                      â–¼              â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚   â”‚   Trivy     â”‚  â”‚    Snyk     â”‚  â”‚       Semgrep          â”‚â”‚
â”‚   â”‚  (Images)   â”‚  â”‚   (SCA)     â”‚  â”‚       (SAST)           â”‚â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Severity Classification

### CVSS-Based Severity Levels

| Severity | CVSS Score | Definition | Example |
|----------|------------|------------|---------|
| **Critical** | 9.0 - 10.0 | Immediate threat, easily exploitable | RCE, auth bypass |
| **High** | 7.0 - 8.9 | Serious threat, requires action | SQL injection, XSS |
| **Medium** | 4.0 - 6.9 | Moderate risk, should be addressed | Info disclosure |
| **Low** | 0.1 - 3.9 | Minor risk, address when possible | Minor misconfig |
| **Informational** | 0.0 | Best practice, no immediate risk | Code quality |

### Context-Adjusted Severity

Base CVSS scores are adjusted based on:

| Factor | Adjustment | Description |
|--------|------------|-------------|
| **Internet Exposed** | +1 | Vulnerability in public-facing service |
| **Contains PII** | +1 | Affects systems processing personal data |
| **Critical Path** | +1 | Affects core business functionality |
| **Mitigating Controls** | -1 | WAF, network isolation in place |
| **No Known Exploit** | -1 | No public exploit available |

### Severity Decision Matrix

```
                        Impact
                Low    Medium    High    Critical
           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    High   â”‚ Medium  â”‚  High   â”‚Critical â”‚Critical â”‚
           â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
Likelihood â”‚  Low    â”‚ Medium  â”‚  High   â”‚Critical â”‚
  Medium   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
           â”‚  Low    â”‚  Low    â”‚ Medium  â”‚  High   â”‚
    Low    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Remediation SLAs

### Standard SLAs by Severity

| Severity | Detection to Triage | Triage to Remediation | Verification |
|----------|--------------------|-----------------------|--------------|
| **Critical** | 4 hours | 24 hours | Same day |
| **High** | 24 hours | 7 days | 48 hours |
| **Medium** | 48 hours | 30 days | 7 days |
| **Low** | 7 days | 90 days | 14 days |
| **Informational** | N/A | Best effort | N/A |

### SLA Escalation Path

```
Time Exceeded    Action
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€    â”€â”€â”€â”€â”€â”€
50% of SLA   â†’   Alert to team lead
75% of SLA   â†’   Alert to security manager
100% of SLA  â†’   Alert to CISO + management
150% of SLA  â†’   Executive escalation
```

### SLA Calculation Rules

1. **Clock Starts**: When vulnerability is confirmed as valid
2. **Clock Pauses**: When waiting on vendor patch (with approved exception)
3. **Clock Stops**: When fix is deployed to production
4. **Business Hours**: SLAs calculated in business hours (9 AM - 6 PM, Mon-Fri)
5. **Critical Exception**: Critical vulnerabilities use 24/7 clock

---

## Remediation Procedures

### Standard Remediation Workflow

```yaml
# GitHub Issue Template: Vulnerability Remediation
name: Security Vulnerability
labels: [security, vulnerability]
assignees: security-team

body:
  - type: input
    id: vuln-id
    label: Vulnerability ID
    description: CVE or internal tracking ID
    placeholder: CVE-2025-XXXXX
    
  - type: dropdown
    id: severity
    label: Severity
    options:
      - Critical
      - High
      - Medium
      - Low
      
  - type: input
    id: affected-component
    label: Affected Component
    
  - type: textarea
    id: description
    label: Description
    
  - type: input
    id: sla-deadline
    label: SLA Deadline
    
  - type: textarea
    id: remediation-plan
    label: Remediation Plan
```

### Remediation Options

| Option | Use When | Approval |
|--------|----------|----------|
| **Patch** | Vendor fix available | Team lead |
| **Upgrade** | Fixed in newer version | Team lead |
| **Workaround** | No patch, mitigation exists | Security manager |
| **Compensating Control** | Can't patch, alternative protection | CISO |
| **Accept Risk** | Low risk, high remediation cost | CISO + management |
| **Retire** | End-of-life system | Architecture review |

### Critical Vulnerability Response

```bash
#!/bin/bash
# critical-vuln-response.sh

VULN_ID="$1"
COMPONENT="$2"

echo "=== CRITICAL VULNERABILITY RESPONSE ==="
echo "Vulnerability: ${VULN_ID}"
echo "Component: ${COMPONENT}"
echo "Time: $(date -u)"

# 1. Create incident
./scripts/create-security-incident.sh \
  --severity critical \
  --vuln-id "${VULN_ID}" \
  --component "${COMPONENT}"

# 2. Notify security team
./scripts/notify-security.sh \
  --channel pagerduty \
  --message "CRITICAL: ${VULN_ID} in ${COMPONENT}"

# 3. Assess exposure
echo "Checking if component is internet-exposed..."
kubectl get ingress -A | grep "${COMPONENT}"

# 4. Consider emergency measures
echo ""
echo "Emergency Options:"
echo "1. kubectl scale deployment ${COMPONENT} --replicas=0"
echo "2. kubectl apply -f network-policy-block-external.yaml"
echo "3. Update WAF rules to block exploit patterns"

# 5. Start remediation tracking
./scripts/start-vuln-timer.sh "${VULN_ID}"
```

---

## Scanning Tool Configuration

### Trivy (Container Scanning)

```yaml
# trivy-config.yaml
scan:
  scanners:
    - vuln
    - misconfig
    - secret
  severity:
    - CRITICAL
    - HIGH
    - MEDIUM
  ignore-unfixed: false
  
vulnerability:
  type:
    - os
    - library
    
misconfig:
  policy-paths:
    - ./policies
  
db:
  no-progress: true
  repository: ghcr.io/aquasecurity/trivy-db
```

### Snyk (Dependency Scanning)

```yaml
# .snyk
version: v1.25.0
ignore:
  # Example: Ignore specific vulnerability with expiry
  SNYK-JS-LODASH-567746:
    - '*':
        reason: 'No fix available, mitigated by input validation'
        expires: 2025-03-01T00:00:00.000Z
        
patch: {}
```

### Semgrep (SAST)

```yaml
# semgrep.yml
rules:
  - p/security-audit
  - p/owasp-top-ten
  - p/python
  - p/typescript
  
paths:
  exclude:
    - tests/
    - node_modules/
    - vendor/
    
severity:
  - ERROR
  - WARNING
```

### Kubescape (Kubernetes Security)

```yaml
# kubescape-config.yaml
scan:
  frameworks:
    - nsa
    - mitre
    - cis-v1.23
    
  excludes:
    - namespaces: [kube-system]
    
  severityThreshold: medium
  
  failThreshold: 0  # Fail on any critical/high
```

---

## Exception Management

### Exception Request Process

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 Vulnerability Exception Flow                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚   Request   â”‚â”€â”€â”€â–¶â”‚   Review    â”‚â”€â”€â”€â–¶â”‚  Approve/   â”‚     â”‚
â”‚  â”‚  Exception  â”‚    â”‚  by SecOps  â”‚    â”‚   Deny      â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                                               â”‚              â”‚
â”‚                            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚                            â–¼                          â–¼     â”‚
â”‚                     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚                     â”‚  Document   â”‚           â”‚  Remediateâ”‚ â”‚
â”‚                     â”‚  Exception  â”‚           â”‚   Normal  â”‚ â”‚
â”‚                     â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                            â”‚                                 â”‚
â”‚                            â–¼                                 â”‚
â”‚                     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                         â”‚
â”‚                     â”‚   Review    â”‚                         â”‚
â”‚                     â”‚  Quarterly  â”‚                         â”‚
â”‚                     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                         â”‚
â”‚                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Exception Criteria

| Criteria | Description | Max Duration |
|----------|-------------|--------------|
| **No Fix Available** | Vendor has not released patch | 90 days |
| **Breaking Change** | Fix requires major refactor | 30 days |
| **False Positive** | Confirmed not exploitable | Permanent |
| **Mitigated** | Compensating controls in place | 90 days |
| **End of Life** | System being decommissioned | Until decom |

### Exception Documentation Template

```yaml
exception_id: EXC-2025-001
vulnerability_id: CVE-2025-XXXXX
severity: High
component: zeus-orchestrator
requested_by: engineer@nuvanta-holding.com
request_date: 2025-12-13

justification: |
  The vulnerable function is not called in our codebase.
  Input validation prevents the attack vector.
  Vendor patch expected in Q1 2025.

compensating_controls:
  - WAF rule blocking exploit pattern
  - Network isolation from internet
  - Enhanced logging on affected endpoint

risk_acceptance:
  residual_risk: Low
  approved_by: ciso@nuvanta-holding.com
  approval_date: 2025-12-14
  expiry_date: 2025-03-14
  review_schedule: Monthly

status: Approved
```

---

## Metrics and Reporting

### Key Performance Indicators (KPIs)

| Metric | Target | Measurement |
|--------|--------|-------------|
| **Mean Time to Detect (MTTD)** | < 24 hours | Discovery to triage |
| **Mean Time to Remediate (MTTR)** | < SLA | Triage to production fix |
| **SLA Compliance Rate** | > 95% | Within SLA / Total |
| **Vulnerability Backlog** | < 50 | Open vulnerabilities |
| **Critical Open** | 0 | Critical vulns > 24 hours |
| **Exception Rate** | < 10% | Exceptions / Total |

### Dashboard Queries

```sql
-- Vulnerability status summary
SELECT 
    severity,
    status,
    COUNT(*) as count,
    AVG(EXTRACT(EPOCH FROM (closed_at - created_at))/3600) as avg_hours_to_close
FROM vulnerabilities
WHERE created_at > NOW() - INTERVAL '30 days'
GROUP BY severity, status
ORDER BY 
    CASE severity 
        WHEN 'Critical' THEN 1 
        WHEN 'High' THEN 2 
        WHEN 'Medium' THEN 3 
        WHEN 'Low' THEN 4 
    END;

-- SLA compliance
SELECT 
    severity,
    COUNT(*) as total,
    SUM(CASE WHEN within_sla THEN 1 ELSE 0 END) as within_sla,
    ROUND(100.0 * SUM(CASE WHEN within_sla THEN 1 ELSE 0 END) / COUNT(*), 1) as compliance_pct
FROM vulnerabilities
WHERE closed_at IS NOT NULL
AND created_at > NOW() - INTERVAL '90 days'
GROUP BY severity;
```

### Monthly Report Template

```markdown
# Vulnerability Management Report - [Month Year]

## Executive Summary
- Total vulnerabilities discovered: X
- Vulnerabilities remediated: Y
- SLA compliance: Z%
- Critical/High open: N

## Metrics
| Severity | Discovered | Remediated | Open | MTTR |
|----------|------------|------------|------|------|
| Critical | X | X | 0 | Xh |
| High | X | X | X | Xd |
| Medium | X | X | X | Xd |
| Low | X | X | X | Xd |

## Trends
[Chart: Vulnerability trend over 6 months]
[Chart: MTTR trend by severity]

## Notable Vulnerabilities
1. [CVE-XXXX]: Description, impact, remediation
2. [CVE-YYYY]: Description, impact, remediation

## Action Items
- [ ] Address backlog of Medium vulnerabilities
- [ ] Complete quarterly exception review
- [ ] Update scanning coverage for new services

## Next Month Focus
- Penetration test scheduled
- New service onboarding
```

---

## Integration with Development

### Developer Guidance

```markdown
## Fixing Vulnerabilities: Developer Guide

### Before You Start
1. Read the vulnerability details in the security ticket
2. Understand the attack vector and impact
3. Review the suggested fix from the scanning tool

### Fix Process
1. Create a branch: `fix/CVE-XXXX-component-name`
2. Implement the fix (usually dependency upgrade)
3. Run local security scan: `make security-scan`
4. Create PR with security label
5. Request security team review

### Common Fixes

**Dependency Upgrade:**
```bash
# Python
pip install package==X.Y.Z
pip freeze > requirements.txt

# Node.js
npm update package
npm audit fix
```

**Code Fix:**
- Add input validation
- Use parameterized queries
- Escape output encoding
- Add authentication/authorization checks

### Testing Your Fix
1. Unit tests pass
2. Security scan passes
3. No new vulnerabilities introduced
4. Functionality unchanged
```

### CI/CD Integration

```yaml
# Security gates in CI/CD
security-check:
  stage: security
  script:
    - trivy image --exit-code 1 --severity CRITICAL,HIGH $IMAGE
    - snyk test --severity-threshold=high
    - semgrep --config auto --error
  rules:
    - if: $CI_PIPELINE_SOURCE == "merge_request_event"
  allow_failure: false  # Block merge on security failures
```

---

## Related Documentation

- [Threat Model](threat-model)
- [Security Architecture](architecture)
- [Incident Response](../04-operations/incident-response/README)
- [Compliance Mapping](compliance-mapping)

---

**Document Owner:** security@nuvanta-holding.com  
**Emergency Contact:** security-emergency@nuvanta-holding.com
